
&НаКлиенте
Перем фПодключен;
&НаКлиенте
Перем РФИД ;
Перем РФИД2 ;



Процедура КнопкаВыполнитьНажатие(Кнопка)
// Вставить содержимое обработчика.
//	ДобавитьОбработчик РФИД., ПриНовомТеге
КонецПроцедуры

Процедура ПриОткрытии()
	ИмяКласса = "RFIDCOM.MyRFID2";
	ИмяКласса2 = "RFIDCOM.RFIDReader";

	Попытка
		
		Результат = ПодключитьВнешнююКомпоненту(ИмяКласса);
		РФИД = Новый COMОбъект (ИмяКласса);
		Результат2 = ПодключитьВнешнююКомпоненту(ИмяКласса2);
		
		РФИД2 = Новый COMОбъект(ИмяКласса2);
		
		ДобавитьОбработчик РФИД2.TagReaded, Таймер;
	Исключение
		Сообщить("Ошибка загрузки внешней компоненты " + ИмяКласса + ". " + ОписаниеОшибки());
		//Закрыть();		
	КонецПопытки;
	
КонецПроцедуры

Процедура ПриНовомТеге(значение)
		Сообщить("Новый тэг! "+значение);
КонецПроцедуры	

Процедура Кнопка1Нажатие(Элемент)
	Попытка
		РФИД2.Start();
		Сообщить("Сканирование запущено!");
	Исключение
		Сообщить("Ошибка запуска сканирования! Текст ошибки: " + ОписаниеОшибки());
	КонецПопытки;
КонецПроцедуры


Процедура Кнопка2Нажатие(Элемент)
	// Вставить содержимое обработчика.
	Попытка
		РФИД.SendEvent();
		Сообщить("Событие!");
	Исключение
		Сообщить("Ошибка запуска сканирования! Текст ошибки: " + ОписаниеОшибки());
	КонецПопытки;

КонецПроцедуры

Процедура Таймер(значение)    
     Сообщить("таймер сработал "+значение);
КонецПроцедуры

